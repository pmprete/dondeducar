@model  dondEducar.ViewModel.EstablecimientoViewModel

<div class="row">
<div id="zen-intro" class="col-xs-6 col-md-4">

    <aside role="complementary" class="sidebar selected col-xs-6">
        <div id="categoria-seleccionada" class="design-selection">
            <h3 class="select"> Nivel Educativo </h3>
            <nav role="navigation">
                <ul>
                    <li>
                        <a href="#"> @Model.NivelEducaivo </a>
                    </li>
                </ul>
            </nav>
        </div>
        <div class="design-selection">
            <h3 class="select hidden">Filtros</h3>
        </div>
          @foreach(var categoria in Model.Categorias)
        {
            <div id="@categoria.Nombre-Filtrada" class="design-selection categoriaFiltrada hidden">
                <h3 class="select">@categoria.Vista</h3>
                <nav role="navigation">
                    <ul>
                        @foreach(var tag in categoria.Tags)
                        {
                            <li class="tag hidden">
                                <a id="@tag.Valor-Filtrado"  href="#" onclick="DesSeleccionarTag(this)">@tag.Vista</a>
                            </li>
                        }
                    </ul>
                </nav>
            </div>
        }
    </aside>

    <aside role="complementary" class="sidebar options col-xs-6">
        @foreach(var categoria in Model.Categorias)
        {
            <div id="@categoria.Nombre" class="design-selection categoria">
                <h3 class="select">@categoria.Vista</h3>
                <nav role="navigation">
                    <ul>
                        @foreach(var tag in categoria.Tags)
                        {
                            <li class="tag">
                                <a id="@tag.Valor" href="#" onclick="SeleccionarTag(this)">@tag.Vista</a>
                            </li>
                        }
                    </ul>
                </nav>
            </div>
        }
    </aside>
 </div>
   
<div role="main" id="zen-supporting" class="main col-xs-12 col-md-8">
    <div role="article" id="zen-explanation" class="explanation">
        <h3>So What is This About?</h3>
        @* grid *@
        <div id="gridEscuelas"></div>
        <div id="pager"></div> 
        @* /grid *@
    </div>
</div>
</div>

<script type="text/javascript">
       
    var columnId = 8;
    
    function SeleccionarTag(anchor) {
        var anchorId = $(anchor).attr('id');
        var categoria = $(anchor).closest('.categoria');
        var categoriaId = categoria.attr('id');
        $(categoria).addClass('hidden');

        var categoriaFiltrada = $('#' + categoriaId + '-Filtrada');
        categoriaFiltrada.removeClass('hidden');
        var tag = $('#' + anchorId + '-Filtrado').closest('.tag');
        tag.removeClass('hidden');
        
        EDUCAR.Grids.ColumnFilters[columnId] = anchorId;

        EDUCAR.Grids.DataView.refresh();
    };

    function DesSeleccionarTag(anchorFiltrado) {
        var tag = $(anchorFiltrado).closest('.tag');
        tag.addClass('hidden');
        var categoriaFiltrada = $(anchorFiltrado).closest('.categoriaFiltrada');
        var categoriaFiltradaId = categoriaFiltrada.attr('id');
        categoriaFiltrada.addClass('hidden');

        var categoria = $('#' + categoriaFiltradaId.replace('-Filtrada', ''));
        $(categoria).removeClass('hidden');

        EDUCAR.Grids.ColumnFilters[columnId] = "";

        EDUCAR.Grids.DataView.refresh();
    };
    
    
    function filter(item) {
        for (var columnId in EDUCAR.Grids.ColumnFilters) {
            if (columnId !== undefined && EDUCAR.Grids.ColumnFilters[columnId] !== "") {
                var c = grid.getColumns()[grid.getColumnIndex(columnId)];
                if (item[c.field] != EDUCAR.Grids.ColumnFilters[columnId]) {
                    return false;
                }
            }
        }
        return true;
    }

    $(document).ready(function () {

        EDUCAR.Grids.Data = @Html.Raw(Model.JsonEstablecimientos);
        
        EDUCAR.Grids.DataView = new Slick.Data.DataView();
        
        EDUCAR.Grids.DataView.setPagingOptions({
            pageSize: 25,
        });

        var grid = new Slick.Grid("#gridEscuelas", EDUCAR.Grids.Data, EDUCAR.Grids.ColumnasEscuelas, EDUCAR.Grids.SlickGridOptions);
        grid.init();
        EDUCAR.Grids.DataView.beginUpdate();
        EDUCAR.Grids.DataView.setItems(EDUCAR.Grids.Data);
        EDUCAR.Grids.DataView.setFilter(filter);
        EDUCAR.Grids.DataView.endUpdate();

        var pager = new Slick.Controls.Pager(EDUCAR.Grids.DataView, grid, $("#pager"));
      
    });
</script>